# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 프로젝트 개요

Flutter 기반 게임 센터 앱으로, 다양한 보드 게임과 카드 게임을 포함합니다.

## 개발 명령어

```bash
# 의존성 설치
flutter pub get

# 앱 실행
flutter run

# 빌드
flutter build apk          # Android
flutter build ios          # iOS
flutter build windows      # Windows

# 분석
flutter analyze
```

## 아키텍처

### 디렉토리 구조
- `lib/main.dart` - 앱 진입점 및 홈 화면 (게임 선택 다이얼로그 포함)
- `lib/games/` - 각 게임별 폴더
- `lib/services/` - 공통 서비스 (게임 저장, Gemini API 등)

### 게임 저장 시스템
`GameSaveService` (`lib/services/game_save_service.dart`)를 통해 게임 상태를 SharedPreferences에 저장합니다.
- 한 번에 하나의 게임만 저장 가능
- 각 게임 화면에서 `hasSavedGame()`, `loadGame()`, `saveGame()`, `clearSavedGame()` 정적 메서드 구현

### 게임 화면 패턴
각 게임은 `lib/games/{game_name}/{game_name}_screen.dart` 형식으로 구성됩니다.
- `resumeGame` 파라미터로 이어하기 지원
- 게임 모드, 난이도 등은 enum으로 정의
- 컴퓨터 AI는 각 게임 화면 내에 구현

### 주요 게임
| 게임 | 파일 | 특징 |
|------|------|------|
| 오목 | `gomoku_screen.dart` | vs 컴퓨터(흑/백), 2인 플레이, 난이도 선택 |
| 오델로 | `othello_screen.dart` | vs 컴퓨터(흑/백), 2인 플레이, 난이도 선택 |
| 체스 | `chess_screen.dart` | vs 컴퓨터(흑/백), 2인 플레이 |
| 장기 | `janggi_screen.dart` | vs 컴퓨터(초/한), 2인 플레이 |
| 원카드 | `onecard_screen.dart` | 2~4인, 컴퓨터 AI |
| 윷놀이 | `yutnori_screen.dart` | 2~4인, 컴퓨터 AI |
| 훌라 | `hula_screen.dart` | 2~4인, 컴퓨터 AI (땡큐, 멜드 등록) |

## 윷놀이 말판 구조

```
          10/28 ─── 9 ─── 8 ─── 7 ─── 6 ─── 5/21
            |  \                             /  |
            |    29                       22    |
           11      \                     /      4
            |        30               23        |
           12          \             /          3
            |           31/24 (중앙)            |
           13          /             \          2
            |        25               32        |
           14      /                     \      1
            |    26                       33    |
            |  /                             \  |
          15/27 ── 16 ── 17 ── 18 ── 19 ── 0/20/34
```

### 위치 번호 체계

#### 외곽 경로 (0-19)
| 위치 | 설명 |
|-----|------|
| 0 | 시작점/우하단 코너 (→34로 변환) |
| 1-4 | 우측 변 (아래→위) |
| 5 | 우상단 코너 (→21로 변환, 멈출 때만) |
| 6-9 | 상단 변 (오른쪽→왼쪽) |
| 10 | 좌상단 코너 (→28로 변환, 멈출 때만) |
| 11-14 | 좌측 변 (위→아래) |
| 15 | 좌하단 코너 |
| 16-19 | 하단 변 (왼쪽→오른쪽) |

#### 우상단 대각선 (21-27)
| 위치 | 설명 |
|-----|------|
| 21 | 우상단 코너 (=5) |
| 22 | 우상단 대각선 1/3 |
| 23 | 우상단 대각선 2/3 |
| 24 | 중앙 (→31로 변환, 멈출 때만) |
| 25 | 중앙→좌하단 1/3 |
| 26 | 중앙→좌하단 2/3 |
| 27 | 좌하단 코너 (→15로 변환, 항상) |

#### 좌상단 대각선 (28-33)
| 위치 | 설명 |
|-----|------|
| 28 | 좌상단 코너 (=10) |
| 29 | 좌상단 대각선 1/3 |
| 30 | 좌상단 대각선 2/3 |
| 31 | 중앙 (=24) |
| 32 | 중앙→우하단 1/3 |
| 33 | 중앙→우하단 2/3 |

#### 특수 위치
| 위치 | 설명 |
|-----|------|
| 34 | 시작점 (=0=20, 한 바퀴 완료) |
| 100 | 골인 완료 |
| -1 | 대기 (출발 전) |

### 자동 변환 규칙

#### 멈출 때만 변환
| 도착 위치 | 변환 | 설명 |
|----------|------|------|
| 5 | 21 | 우상단 코너에서 대각선 진입 |
| 10 | 28 | 좌상단 코너에서 대각선 진입 |
| 24 | 31 | 중앙에서 우하단 방향으로 변경 |

#### 항상 변환 (지나갈 때도)
| 도착 위치 | 변환 | 설명 |
|----------|------|------|
| 27 | 15 | 좌하단 코너로 외곽 합류 |
| 0 | 34 | 시작점 |
| 20 | 34 | 한 바퀴 완료 |

### 경로

#### 우상단 대각선 경로
```
21 → 22 → 23 → 24(→31) → 32 → 33 → 골인
                ↓ (지나갈 때)
               25 → 26 → 27(→15) → 16 → 17 → 18 → 19 → 34 → 골인
```

#### 좌상단 대각선 경로
```
28 → 29 → 30 → 31 → 32 → 33 → 골인
```

#### 외곽 경로
```
1 → 2 → 3 → 4 → 5(→21) → ... (대각선으로)
                    ↓ (지나갈 때)
                    6 → 7 → 8 → 9 → 10(→28) → ... (대각선으로)
                                        ↓ (지나갈 때)
                                       11 → ... → 15 → 16 → 17 → 18 → 19 → 34 → 골인
```

## 훌라 게임 규칙

### 턴 진행
- `currentTurn`: 0 = 플레이어, 1~3 = 컴퓨터
- 턴 변경 시 반드시 `_saveGame()` 호출 필요 (이어하기 정확성)
- 땡큐 시스템: 다른 플레이어가 버린 카드를 가져갈 수 있음

### 멜드 시스템
- Run: 같은 무늬 연속 3장 이상
- Group: 같은 숫자 3~4장
- 7 카드: 단독 등록 가능, 다른 플레이어 멜드에 붙여놓기 가능
